void set_next_right(struct node * root)
{
    struct node * cur = root;
    struct node * last = NULL;
    int level = 0, i;
    struct node * array[MAX_LEVEL] = {NULL};

    if (cur == NULL)
        return;

    push(cur);
    level++;

    do
    {
        cur = top();
        if (cur == NULL)
            return;
        if (last == NULL || last->left == cur || last->right == cur)
        {
            if (cur->right)
            {
                push(cur->right); level ++;
            } else if (cur->left)
            {
                push(cur->left); level ++;
            }
            else
            {
                pop(); level –;
                cur->next_right = array[level];
                array[level] = cur;
            }
        } else if (last == cur->right)
        {
            if (cur->left)
            {
                push(cur->left); level ++;
            } else {
                pop(); level –;
                cur->next_right = array[level];
                array[level] = cur;
            }
        } else {
                pop(); level –;
                cur->next_right = array[level];
                array[level] = cur;
        }
        last = cur;
    } while (1);
}